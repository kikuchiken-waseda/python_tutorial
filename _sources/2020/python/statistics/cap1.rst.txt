===========================
ベイジアン推論入門
===========================

- 文責: takuya.waseda.1119@gmail.com
- 作成日: 2020-05-02

本章ではベイズ統計でよく使用する概念および,
ベイジアン分析における基本的な
ツールキットの使い方を記述します.

ここではいくつかのコードを利用しますが、
殆どが論理に関する話になります.

.. contents::
    :depth: 2


統計モデリング
===========================

統計学はデータを収集し、組織化し、分析し、解釈する学問です.
そのため、統計学の知識とはデータ分析を行う際に "本質" 的なものは何なのかという知識になります.

一方で, 一般的に大学の講義で扱うような "とーけーの授業" は, 少なくとも統計学者ではない人々にとって "家庭科" の時間と一緒です. ここでは凡そ次のような "料理" を教えられます.
まず, 統計ツール収納ボックス(R とか SPSS とか エクセル とか呼ばれています) に行きます. そこには, 例えば T-検定 とか, 分散分析と呼ばれるレトルト缶が入っています.
先生に言われた缶を取り出し, 味付けを一寸整えて(データを少し変えてみて), 適切な p 値が出るまで煮詰めます.
大体のレトルト食品が 5 分を目安に調理を終えるのと同様に,
とーけーの授業では p 値が 0.05 より小くなれば完成です.
この講義の主要な目的は、適切なレトルト缶をどのように選ぶのかを教えることです.

ベイズ統計は, もう少し実践的です.
勿論、所詮は "料理" なのでレシピがありますし,
それを作るわけですが, それらのレシピはレトルト缶のような既製品ではなく, 自家製のものになるでしょう(丁度自宅で作る糠床のように). まず, 冷蔵庫を確認して, そこにある素材から, 適切なランチを作ることがベイズ統計のアプローチです.

しかし, そうは行っても料理の基本はあるわけです(丁度, "緑のたべもの" や "黄色のたべもの" のように).
まずは、この辺の用語, 概念を学んでいきましょう.

探索的データ分析
------------------------------

データは統計学の基本になる素材です.
これは, たとえば, 実験, コンピュータシミュレーション, 調査, フィールド監察など、様々な方法で取得することができます.

もし、データ分析を行いたいと考えるなら,
まず、答えたい問題がなんであって, それに答えるためにどのようなデータをどのように取得するべきかを, 事前に考えるのは大事なことです.
事実, `実験計画法 <https://ja.wikipedia.org/wiki/%E5%AE%9F%E9%A8%93%E8%A8%88%E7%94%BB%E6%B3%95>`_ として知られるデータ収集を扱う学問は統計学の重要な一角をになっています.
クラウドを利用してデータを簡単に収集できる時代になり、
忘れられがちですが, データ収集そのものは決して安価なものでもない場合もあるのです (一般に, 安価な食材より, 高級な食材の方がおいしい料理ができるものです).
ただし, このチュートリアルの中では, 食材の準備はもう済んでおり(現実的には, ここにこそ時間が掛かるものですが), それらの食材を使う下準備は済んでいます.
データ加工に関するチュートリアルは別途用意する(かも知れない)ので, そちらをご確認ください.

さて, データ収集(食材準備および下処理)は済んでいるとして,
手元にあるデータについて, ある種の直感を得るために,
データを調べたり, 可視化することはとてもよいアイディアです.
このアイディアのことを **探索的データ分析** (exploratory data analysis; EDA) といいます.

これは基本的に以下二つの要素で構成されます:

1. 記述統計学
2. データ可視化

まず, 記述統計学は, 数量的にデータを要約したり,
特徴づけるためにどの測度(統計量)をどのように使うのかを扱います. 皆様は既に, 平均, 最頻値, 四分位数などを使ってデータを記述する方法を知っているかもしれません.

二つ目のデータ可視化は,
データを視覚的に調べるものであり,
ヒストグラムや, 散布図などの表現があります.
もともと EDA は, なんからの複雑な分析にかける前のデータに適用したり, 複雑なモデルに基づいた分析にかけるために適用したりするものだとされてきました.
しかし, EDA はベイス統計の結果を理解し, 解釈し, 要約し,
情報伝達するためにも利用可能です.

推測統計学
------------------------------

探索的データ分析で説明した通り,
データをグラフ表示し,
データの平均値など簡単な数値を計算すれば充分な場合もあります.
一方で, データに基づいた一般化を行いたいと思うこともあります.
データを生み出す背後にあるメカニズムを理解したいのかもしれませんし, 将来の (まだ観測されていない) 数値を予測したいのかもしれません. あるいは, いくつかの競合する説明の中からどれか一つを撰必要があるのかもしれません.
これらは **推測統計学** (inferential statistics) の仕事です.
推測統計学を行うには, 確率モデルに頼ることになります.
多くのタイプのモデルが存在しますが,
ほとんどの科学は，現実世界にちて私たちが理解する全てを追加したモデルを通じて行われます.
能は正に現実(それが何であるにせよ)をモデル化する機械です.

モデルとは何でしょう?
モデルは, 与えられたシステムあるいは過程の記述を簡単にするものです.これらの記述はシステムの最も重要な特徴を把握するように,
目的を持って設計されます.
従って, ほとんどのモデルはすべての特徴を説明することを意図していません.
一方で, 簡単なモデルと複雑なモデルがあり，
両方ともデータを同程度説明することができるなら，
一般には, 単純なシステムが好まれます.
この, 単純なモデルが好まれるという ヒューリスティクス [注:2020-python-statistics-1-1]_ はオッカムの剃刀として知られ,
:doc:`./cap6` において, ベイジアン分析とこのオッカムの剃刀がどう関係するのかを議論します.

モデリングは, 構築するモデルがどのようなものであれ,
おおよそ, 次の 3 つのステップに要約することができます.

1. 何らかのデータを所与とし, また, そのデータがどのように生成されたのかについて何らかの仮定を置いて, モデリングします. ほとんどの場合, モデルは大雑把な近似になります. しかし, これが私たちの必要とするすべてなのです.
2. その後, ベイズの定理を使い 私たちのモデル にデータを与え, データと仮定を結合させることによって論理的な結果を導き出します.このことを「データに基づいてモデルを条件づける」といいます.
3. 最後に, データや私達が調べているテーマに関する専門知識を含め, 様々な基準に照らし合わせてモデルが理に適っているのかをチェックします.

一般的には, 非線形の反復様式によるこれら 3 つのステップを
実行することで, 私たちは自分自身について気づきます.
私達が作ったプログラムに愚かなミスが含まれる場合があること,
モデルに変更/改善する方法が見つかるかもしれないこと,
より多くのデータを追加する必要があるかもしれないことなどです.
しして 任意の時点で諸ステップを私達は再追跡することになるでしょう.

ベイジアンモデルは **確率モデル** (probabilistic model) としても知られます.
というのも, それは確率をつかって構築されるからです.
なぜ確率を使うのでしょうか?
確率はデータにおける不確実性をモデル化するための
正しい数学的な道具なのです.
それでは, いくつも枝分かれする小径のある庭 (garden of forking path) [注:2020-python-statistics-1-2]_ で散歩を始めましょう.


.. [注:2020-python-statistics-1-1] 発見的方法と訳されることがあります.正確な答えを導く方法ではないけれど, おおよそ上手くいく答えを導く方法や考え方を意味します.
.. [注:2020-python-statistics-1-2] 付加される条件によって確率が分岐していく様子をたとえた表現です



確率と不確実性
===========================


ベイズの定理と統計的推論
===========================

単一パラメータ推論と伝統的なコイン投げ問題
======================================================

事前分布の選択および, それが本当は好まれるのに好まれない理由
=============================================================


ベイジアン分析の報告
=============================================================
